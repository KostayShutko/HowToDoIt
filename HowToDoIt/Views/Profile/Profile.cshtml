@model HowToDoIt.Models.Classes_for_Db.Profile
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<link rel='stylesheet' href='~/Content/InstructionButton/StyleFromGit.css'>


<h3>Personal info</h3>
<form class="form-horizontal" role="form">
    <div class="form-group">
        <label class="col-md-2 control-label">Аватар:</label>
        <div class="col-md-10">
            <div class="profile">
                <div class="profile-avatar-wrap">
                    <img  id="profile-avatar" src= "@Url.Content(Model.Avatar)" alt="Image for Profile">
                    <input type="hidden" id="info" name="info" value="@Model.Id">
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label class="col-md-2 control-label">Имя:</label>
        <div class="col-md-5">
            <input id="firstName" class="form-control" type="text" value="@Model.FirtstName">
        </div>
    </div>
    <div class="form-group">
        <label class="col-md-2 control-label">Фамилия:</label>
        <div class="col-md-5">
            <input id="lastName" class="form-control" type="text" value="@Model.LastName">
        </div>
    </div>
    <div class="form-group">
        <label class="col-md-2 control-label">Пол:</label>
        <div class="col-md-5">
            @if (Model.Sex == "man")
            {
                <label class="radio-inline"><input id="man" type="radio" checked name="optradio">Мужчина</label>
                <label class="radio-inline"><input id="woman" type="radio" name="optradio">Женщина</label>
            }
            else
            {
                <label class="radio-inline"><input id="man" type="radio"  name="optradio">Мужчина</label>
                <label class="radio-inline"><input id="woman" type="radio" checked name="optradio">Женщина</label>
            }
        </div>
    </div>
    <div class="form-group">
        <label class="col-md-2 control-label">Город:</label>
        <div class="col-md-5">
            <input id="city" class="form-control" type="text" value="@Model.City">
        </div>
    </div>
    <div class="form-group">
        <label class="col-md-2 control-label">Контакты:</label>
        <div class="col-md-5">
            <textarea id="contact" class="form-control" type="text" >@Model.Contacts</textarea>
        </div>
    </div>
    <div class="form-group">
        <label class="col-md-2 control-label">Интересы:</label>
        <div class="col-md-5">
            <textarea id="interest" class="form-control" type="text" >@Model.Interests</textarea>
        </div>
    </div>
</form>



<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="~/Scripts/dowland/resample.js"></script>
<script src="~/Scripts/dowland/avatar.js"></script>
<script type='text/javascript'>
    $('input, textarea').on('change', function () {
        // отправка на сервер
        SendData();
    });
    $('img').on('load', function () {
        SendData();
    });

    function SendData() {
        var object = new Object();
        

        object.FirtstName = $("#firstName").val();
        object.LastName = $("#lastName").val();
        var inp = document.getElementsByName('optradio');
        for (var i = 0; i < inp.length; i++) {
            if (inp[i].type == "radio" && inp[i].checked) {
                object.Sex = inp[i].id;
            }
        }
        object.City = $("#city").val();
        object.Contacts = $("#contact").val();
        object.Interests = $("#interest").val();
        object.Avatar = $('#profile-avatar').attr('src');
        object.Id = $("#info").val();
        $.ajax({
                    type: "POST",
                    url: '@Url.Action("SaveProfileData", "Profile")',

                    data: object,
                    success: function (response) {

                    },
                    });
    };
</script>
